"use strict";(self.webpackChunkarchway_docs=self.webpackChunkarchway_docs||[]).push([[1874],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,y=u["".concat(l,".").concat(m)]||u[m]||d[m]||o;return n?a.createElement(y,i(i({ref:t},s),{},{components:n})):a.createElement(y,i({ref:t},s))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:r,i[1]=p;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2366:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return p},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return s},default:function(){return u}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],p={sidebar_position:4},l="Deploying your dApp on chain",c={unversionedId:"create/guides/my-first-dapp/deploy",id:"create/guides/my-first-dapp/deploy",isDocsHomePage:!1,title:"Deploying your dApp on chain",description:"When you're ready to deploy an on chain build we can start Docker (if not already running) and use the archway deploy command.",source:"@site/docs/create/guides/my-first-dapp/deploy.md",sourceDirName:"create/guides/my-first-dapp",slug:"/create/guides/my-first-dapp/deploy",permalink:"/docs/create/guides/my-first-dapp/deploy",editUrl:"https://github.com/archway-network/archway-docs/edit/main/docs/create/guides/my-first-dapp/deploy.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Producing Wasm executables",permalink:"/docs/create/guides/my-first-dapp/wasm"},next:{title:"Interacting with your dApp",permalink:"/docs/create/guides/my-first-dapp/interact"}},s=[],d={toc:s};function u(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"deploying-your-dapp-on-chain"},"Deploying your dApp on chain"),(0,o.kt)("p",null,"When you're ready to deploy an on chain build we can start Docker (if not already running) and use the ",(0,o.kt)("inlineCode",{parentName:"p"},"archway deploy")," command."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo service docker start\narchway deploy\n")),(0,o.kt)("p",null,"To skip the CLI asking for default values required by your dApp, include constructor arguments using the ",(0,o.kt)("inlineCode",{parentName:"p"},"--args")," parameter. Format your constructor parameters as a ",(0,o.kt)("inlineCode",{parentName:"p"},"JSON")," encoded string."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'archway deploy --args \'{"my_key":"my value"}\'\n')),(0,o.kt)("p",null,"If you cloned the 'Increment' starter template, try deploying with your ",(0,o.kt)("inlineCode",{parentName:"p"},"counter")," argument set to ",(0,o.kt)("inlineCode",{parentName:"p"},"0"),"; e.g. ",(0,o.kt)("inlineCode",{parentName:"p"},"archway deploy --args '{\"count\":0}'")),(0,o.kt)("p",null,"If you didn't deploy with ",(0,o.kt)("inlineCode",{parentName:"p"},"--args"),", you'll need to enter that information into the CLI anyway, but why is the constructor ",(0,o.kt)("inlineCode",{parentName:"p"},'{"count":0}')," and how can we verify it? "),(0,o.kt)("p",null,"Open ",(0,o.kt)("inlineCode",{parentName:"p"},"src/contract.rs"),", near the top you'll see ",(0,o.kt)("inlineCode",{parentName:"p"},"pub fn instatiate")," which sets state in the contract at instatiation:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"let state = State {\n  count: msg.count, // Here's our count declaration\n  owner: info.sender.clone(), // Contract owner is wallet that sent tx\n};\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"archway deploy")," is a developer super command that produces huge output. Since we're running the command without ",(0,o.kt)("inlineCode",{parentName:"p"},"--dryrun")),(0,o.kt)("p",null,"It doesn't make sense to list all of that output here, instead let's look at a step-by-step anatomy of what the command does. There are 5 steps in total."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"MAKE WASM")," - ",(0,o.kt)("em",{parentName:"li"},"Produces ",(0,o.kt)("inlineCode",{parentName:"em"},"wasm")," executable optimized and compressed with ",(0,o.kt)("inlineCode",{parentName:"em"},"cosmwasm/rust-optimizer"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"CREATE ON CHAIN WASM")," - ",(0,o.kt)("em",{parentName:"li"},"Uploads ",(0,o.kt)("inlineCode",{parentName:"em"},"wasm")," executable on chain")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"VERIFY UPLOAD INTEGRITY")," - ",(0,o.kt)("em",{parentName:"li"},"Downloads the uploaded ",(0,o.kt)("inlineCode",{parentName:"em"},"wasm")," and verifies on chain version matches checksum of local build")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"INSTANTIATE CONTRACT")," - ",(0,o.kt)("em",{parentName:"li"},"Creates an instance of the uploaded contract")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"STORE DEPLOYMENT LOG")," - ",(0,o.kt)("em",{parentName:"li"},"Creates log entries for steps 2 (upload) and 4 (instantiation) in ",(0,o.kt)("inlineCode",{parentName:"em"},"config.json")))),(0,o.kt)("p",null,"If you suceeded in deploying you'll now be able to query and transact with your dApp, but if you're unsure or suspect something may have gone wrong, check your deployments history using the ",(0,o.kt)("inlineCode",{parentName:"p"},"archway history")," command. Or, by opening ",(0,o.kt)("inlineCode",{parentName:"p"},"config.json")," at the root of the project and looking at the ",(0,o.kt)("inlineCode",{parentName:"p"},"deployments")," array. "),(0,o.kt)("p",null,"In your history you'll see 2 transactions were created: the ",(0,o.kt)("inlineCode",{parentName:"p"},"create")," transaction from when it was uploaded on chain; and, the ",(0,o.kt)("inlineCode",{parentName:"p"},"instantiate")," transaction which made an on chain instance that can queried and transacted with."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"archway history\n")),(0,o.kt)("p",null,"Example output:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"Printing deployments...\n\n[\n  {\n    type: 'instatiate',\n    address: 'wasm1rfa3scumm5y2lt6jku49hg52y2tk06pnsm9p6w',\n    chainId: 'pebblenet-1',\n    data: '{...}'\n  },\n  {\n    type: 'create',\n    codeId: '84',\n    chainId: 'pebblenet-1',\n    data: '{...}'\n  }\n]\n")))}u.isMDXComponent=!0}}]);